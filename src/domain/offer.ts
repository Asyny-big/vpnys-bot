export class OfferNotAcceptedError extends Error {
  constructor() {
    super("Public offer is not accepted");
    this.name = "OfferNotAcceptedError";
  }
}

export function isOfferAccepted(
  user: { offerAcceptedAt?: Date | null; offerVersion?: string | null },
  currentOfferVersion: string,
): boolean {
  void currentOfferVersion;
  return !!user.offerAcceptedAt;
}

export function shortPublicOfferText(): string {
  return [
    "ПУБЛИЧНАЯ ОФЕРТА (кратко)",
    "",
    "1) Предмет услуги: Исполнитель предоставляет Пользователю доступ к цифровому сервису удалённого доступа на условиях выбранного тарифа.",
    "2) Момент оказания услуги: услуга считается оказанной с момента предоставления доступа (выдачи/активации доступа в сервисе).",
    "3) Ограничение ответственности: Исполнитель не отвечает за невозможность использования сервиса по причинам, не зависящим от Исполнителя (сбои связи, оборудования, программного обеспечения, действия третьих лиц), и не несёт ответственность за косвенные убытки и упущенную выгоду.",
    "4) Возврат средств: возврат возможен при технической невозможности предоставления доступа по вине Исполнителя; в иных случаях возврат не производится. При частично оказанной услуге возврат рассчитывается пропорционально неиспользованному периоду.",
    "5) Конклюдентный акцепт: совершение Пользователем действий по использованию бота и/или оплате услуг означает согласие с условиями настоящей оферты.",
    "",
    "\u00AB" + "Продолжая использование бота, Пользователь подтверждает своё согласие с условиями настоящей оферты (конклюдентный акцепт)." + "\u00BB",
  ].join("\n");
}

export function safeYooKassaDescription(planDays: number): string {
  const days = Math.max(1, Math.floor(Number.isFinite(planDays) ? planDays : 0));
  return `Подписка на цифровой сервис удалённого доступа сроком на ${days} дней`;
}
